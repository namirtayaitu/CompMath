# Простой код для построения трёх типов конечных разностей
# Горизонтальные таблицы, как в учебнике

# Шаг 1: ВВЕДИ СВОИ ДАННЫЕ
x = [10, 20, 30, 40, 50]          # равномерная сетка!
y = [1.1, 2.0, 4.4, 7.9, 12.8]    # f(x)

n = len(y)
h = x[1] - x[0]  # шаг (должен быть одинаковым)

print(f"Шаг h = {h}\n")
print("="*60)


# --------------------------------------------------
# 1. ПРЯМЫЕ РАЗНОСТИ (∆)
# ∆f(x_i) = f(x_{i+1}) - f(x_i)
# --------------------------------------------------
print("1. Прямые разности (∆):")
table_d = [[None for _ in range(n)] for _ in range(n)]
for i in range(n):
    table_d[i][0] = y[i]

for k in range(1, n):
    for i in range(n - k):
        table_d[i][k] = table_d[i+1][k-1] - table_d[i][k-1]

# Вывод
print(f"{'x':>6} {'f(x)':>10}", end="")
for k in range(1, n):
    print(f"{f'∆^{k}f':>10}", end="")
print()
for i in range(n):
    print(f"{x[i]:>6} {table_d[i][0]:>10.4g}", end="")
    for k in range(1, n):
        val = table_d[i][k]
        if val is not None:
            print(f"{val:>10.4g}", end="")
        else:
            print(" " * 10, end="")
    print()
print("\n" + "-"*60)


# --------------------------------------------------
# 2. ОБРАТНЫЕ РАЗНОСТИ (∇)
# ∇f(x_i) = f(x_i) - f(x_{i-1})
# --------------------------------------------------
print("2. Обратные разности (∇):")
table_b = [[None for _ in range(n)] for _ in range(n)]
for i in range(n):
    table_b[i][0] = y[i]

for k in range(1, n):
    for i in range(k, n):  # начинаем с i = k
        table_b[i][k] = table_b[i][k-1] - table_b[i-1][k-1]

# Вывод
print(f"{'x':>6} {'f(x)':>10}", end="")
for k in range(1, n):
    print(f"{f'∇^{k}f':>10}", end="")
print()
for i in range(n):
    print(f"{x[i]:>6} {table_b[i][0]:>10.4g}", end="")
    for k in range(1, n):
        val = table_b[i][k]
        if val is not None:
            print(f"{val:>10.4g}", end="")
        else:
            print(" " * 10, end="")
    print()
print("\n" + "-"*60)


# --------------------------------------------------
# 3. ЦЕНТРАЛЬНЫЕ РАЗНОСТИ (δ)
# δf(x_i) = f(x_{i+1/2}) - f(x_{i-1/2}) → но у нас только узлы!
# Поэтому: δf(x_i) ≈ f(x_{i+1}) - f(x_{i-1})  (на практике часто так)
# Но строго: δf(x_{i+1/2}) = f(x_{i+1}) - f(x_i)
# Чтобы не путаться, построим δ на полуузлах, но покажем в таблице между точками.
# Однако для простоты (как в учебниках) часто используют:
#   δ²f(x_i) = f(x_{i+1}) - 2f(x_i) + f(x_{i-1})
# Но полная таблица δ — сложнее. Сделаем упрощённую версию:
# --------------------------------------------------
print("3. Центральные разности (δ) — приближённо:")
# Мы построим только чётные порядки в узлах, нечётные — между узлами.
# Для простоты выведем только δ²f, δ⁴f и т.д. в узлах.

# Создадим таблицу, где δ^k f(x_i) определено только при i >= k//2 и i <= n-1 - k//2
table_c = [[None for _ in range(n)] for _ in range(n)]

# Нулевой порядок
for i in range(n):
    table_c[i][0] = y[i]

# Первый порядок: δf(x_{i+0.5}) = f(x_{i+1}) - f(x_i) → будем хранить в строке i, но это "между"
# Но чтобы не усложнять, сделаем так:
#   δ²f(x_i) = f(x_{i+1}) - 2f(x_i) + f(x_{i-1})
for i in range(1, n-1):
    table_c[i][2] = y[i+1] - 2*y[i] + y[i-1]

# Четвёртый порядок (если данных достаточно)
if n >= 5:
    for i in range(2, n-2):
        table_c[i][4] = y[i+2] - 4*y[i+1] + 6*y[i] - 4*y[i-1] + y[i-2]

# Вывод (покажем только чётные столбцы)
print(f"{'x':>6} {'f(x)':>10} {'δ²f':>10} {'δ⁴f':>10}")
for i in range(n):
    row = f"{x[i]:>6} {table_c[i][0]:>10.4g}"
    # δ²f
    if table_c[i][2] is not None:
        row += f"{table_c[i][2]:>10.4g}"
    else:
        row += " " * 10
    # δ⁴f
    if table_c[i][4] is not None:
        row += f"{table_c[i][4]:>10.4g}"
    else:
        row += " " * 10
    print(row)

print("\n" + "="*60)